name: "Unsea Security Analysis"

disable-default-queries: false

queries:
  - uses: security-and-quality
  - uses: security-extended
  # Additional crypto-specific queries
  - uses: codeql/javascript-queries:Security/CWE-327
  - uses: codeql/javascript-queries:Security/CWE-329
  - uses: codeql/javascript-queries:Security/CWE-330

query-filters:
  - exclude:
      id: js/incomplete-sanitization
  - exclude:
      id: js/incomplete-multi-character-sanitization
  # Include crypto-specific checks
  - include:
      id: js/weak-cryptographic-algorithm
  - include:
      id: js/insufficient-key-size
  - include:
      id: js/hardcoded-credentials

paths:
  - src/
  - test/
  - example/
  - dist/

paths-ignore:
  - node_modules/
  # Note: We DO scan dist/ and minified files for security issues
  # in the built artifacts that users consume

# Custom queries for cryptographic code
packs:
  - codeql/javascript-queries
  - codeql/security-queries
